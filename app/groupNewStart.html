<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>建立新露營團</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.js"></script> 
    <script src="./vender/vue/vue.min.js"></script>
    <script src="./vender/jquery/jquery-3.5.1.min.js"></script>
    <script src="./js/main.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="./pic/commom/browser.ico">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <div id="groupAllList">
    <!-- header開始-->
    @@include('./layout/header.html', { "underline_01": "orange2" })
    <!-- 燈箱開始 -->
    @@include('./layout/login.html')
    <!-- 燈箱結束 -->
        <section class="section1 bgcColor">
            <div class="wrap">
                <div class="level11 green1">
                    建立新露營團
                </div>
                <div class="breadcrumbs">
                    <ul>
                        <li><a href="./shansen.html"  class="level0 green1">首頁</a></li>
                        <li><a href="./group.html"  class="level0 green1">揪團露營</a></li>
                        <li class="level0 gray1">建立新露營團</li>
                    </ul>
                </div>
                <form action="#" class="groupNewStart group">
                    <div class="top level7 green1">
                        填寫建團資訊
                    </div>
                    <div class="left">
                        <div class="level1 green1">
                            上傳營地相關照片:
                        </div>
                        <div class="pic">
                            <label class="uploadImg">
                                <input type="file" id="theFile" multiple>
                                <img src="pic/equipment/photo-camera.svg" alt="">
                                <span class="level0 gray2">(請上傳三張照片)</span>
                            </label>
                            <div class="imgs">
                                <div class="img" id="img0">
                                </div>
                                <div class="img" id="img1">
                                </div>
                                <div class="img" id="img2">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="right">
                        <div class="infoInput">
                            <div class="level1 gray1">
                                <div class="block">
                                    <div class="green1 level1">露營團名 :</div>
                                    <div><input type="text" class="text inputstyle" placeholder="請為您的團隊取名"></div>
                                </div>
                                <div class="block">
                                    <div class="green1 textinfo level1">相關介紹 :</div>
                                    <div><textarea name="" id="" class="inputstyle" cols="40" rows="4" placeholder="可分享營地資訊或心得⋯⋯"></textarea></div>
                                </div>
                                <div class="block">
                                    <div class="green1 level1">選擇地區 :</div>
                                    <div>
                                        <select class="inputstyle level1 gray1" id="camArea">
                                            <!-- <option >北部</option>
                                            <option >中部</option>
                                            <option >南部</option>
                                            <option >東部</option> -->
                                        </select>
                                        <select class="inputstyle level1 gray1" id="camName">
                                        </select>
                                        <a href="./camping.html"><input type="button" id="toCamping" class="thirdbtn2_orange" value="營區參考"></a>
                                    </div>
                                </div>
                                <div class="block">
                                    <div class="green1 level1">人數上限 :</div>
                                    <div><input type="number" class="inputstyle" placeholder="1" min="1">人(含主揪)</div>
                                </div>
                                <div class="block">
                                    <div class="green1 level1">出團日期 :</div>
                                    <div><input type="date" name="startdate" class="inputstyle level1 gray1" id="startdate"></div>
                                </div>
                                <div class="block">
                                    <div class="green1 level1">結束日期 :</div>
                                    <div><input type="date" name="enddate" class="inputstyle level1 gray1" id="enddate"></div>
                                </div>
                                <div class="block">
                                    <div class="green1 level1">須具備設備 :</div>
                                    <div id="equSort">
                                        <!-- <label class="level1">
                                            <input type="checkbox" class="type">
                                            露營帳篷
                                        </label>
                                        <label class="level1">
                                            <input type="checkbox" class="type">
                                            睡袋
                                        </label>
                                        <label class="level1">
                                            <input type="checkbox" class="type">
                                            其他
                                        </label> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="btn">
                            <input type="button" class="mainbtn2" value="暫存資料">
                            <a href="./groupNewStart_check.html"><input type="button" class="mainbtn1" value="預覽發文"></a>
                        </div>
                    </div>

                </form>
            </div>
        </section>
        <!-- footer 開始-->
        @@include('./layout/footer.html')
        <!-- footer 結束-->
    </div>
    <Script>
        $(document).ready(function(){
            //上傳圖片
            $("#theFile").change(function(){
                var imgPath = $(this)[0].value;
                var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
                if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
                    if (typeof (FileReader) != "undefined") {
                        for (var i = 0; i < 3; i++) {
                            let image_holder= $("#img"+i);
                            image_holder.empty();
                            var reader = new FileReader();
                            reader.onload = function (e) {
                                $("<img />", {
                                    "src": e.target.result,
                                    // "class": "thumb-image"
                                }).appendTo(image_holder);
                            }
                            image_holder.show();
                            reader.readAsDataURL($(this)[0].files[i]);
                        }
                    } else {
                        alert("This browser does not support FileReader.");
                    }
                }else{
                    alert("Pls select only images");
                }
            });           
        });
    </Script>
    <script src="./js/logintext.js"></script>
    <script>
        var city;
        function listArea(areajson){
            city = JSON.parse(areajson);
            console.log(city);
            //區域排除重複
            let area=[];
            for(let i = 0; i<city[0].length;i++){
                area[i]=city[0][i].CAM_AREA;
            }
            let onlyarea = area.filter(function(element, index, arr){
                return arr.indexOf(element) === index;
            });
            for(let i = 0; i < onlyarea.length ; i++){
                let option = document.createElement("option");
                option.innerText=onlyarea[i];
                option.value=onlyarea[i];
                document.getElementById("camArea").appendChild(option);

            }
            let nowarea = document.getElementById("camArea").value;
            for(let i = 0; i<city[0].length;i++){
                if(city[0][i].CAM_AREA == nowarea){

                    let option = document.createElement("option");
                    option.innerText=city[0][i].CAM_NAME;
                    option.value=city[0][i].CAM_NAME;
                    document.getElementById("camName").appendChild(option);
                }
            }
            for(let i = 0; i<city[1].length;i++){
                let label = document.createElement("label");
                label.className = "level1";
                label.innerHTML = `<input type="checkbox" class="type">${city[1][i].EQUSORT_EQUNAME} `;
                document.getElementById("equSort").appendChild(label);
            }
        }
        document.getElementById("camArea").onchange = function(){
            // console.log(city);
            document.getElementById("camName").innerHTML="";
            var nowarea = document.getElementById("camArea").value;
            for(let i = 0; i<city[0].length;i++){
                if(city[0][i].CAM_AREA == nowarea){
                    let option = document.createElement("option");
                    option.innerText=city[0][i].CAM_NAME;
                    option.value=city[0][i].CAM_NAME;
                    document.getElementById("camName").appendChild(option);
                }
            }
        }
        function doFirst(){
            let areaxhr = new XMLHttpRequest();
            areaxhr.onload = function(){
                if(areaxhr.status == 200){ //success
                    if(!member.MEM_ID){
                        showLoginForm();
                        btnLoginCancel=$id("btnLoginCancel");
                        btnLoginCancel.addEventListener('click',function(){
                            history.go(-1);
                        });
                            // window.location.href='./groupNewStart.html';
                        }
                    // alert(member.MEM_ID);
                    // alert(areaxhr.responseText);
                    listArea(areaxhr.responseText);
                }else{ //error
                    alert(areaxhr.status);
                }
            }
            areaxhr.open("get", `./php/group/area.php`, true);
            areaxhr.send(null);
        }

        window.addEventListener('load',doFirst);
    </script>
</body>
</html>