<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>後台</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" href="./pic/commom/browser.ico">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.20.0/axios.min.js"></script>
    <!-- <script src="./vender/vue/vue.min.js"></script> -->
</head>
<body class="bgcColor">
<header class="back_header">
    <img src="./pic/commom/phone_header.svg">
    <div class="back_login">
        <span class="back_username">斯斯感冒膠囊</span>
        <span class="back_loginbtn">登出</span>
    </div>
</header>

 <div id="app" class="back_page"><!--HTML DOM template-->
        <div class="back_page_leftside">
            

                <div class="back_list_title">管理員管理
                    <button class="back_list" @click="content='back-manager'">管理員管理</button>
                </div>

                <div class="back_list_title">檢舉管理
                    <button class="back_list" @click="content='back-rep-group'">揪團檢舉管理</button>
                    <button class="back_list" @click="content='back-rep-message'">揪團留言檢舉管理</button>
                    <button class="back_list" @click="content='back-rep-equ'">設備檢舉管理</button>
                </div>

                <div class="back_list_title">小知識管理
                    <button class="back_list" @click="content='back-game-manage'">小知識管理</button>
                </div>



        </div>

    

        <div class="back_page_rightside">
            <!--Vue開始-->
            <keep-alive>
                <component :is="content"></component>
                <!-- 透過component元素，去指定其屬性is進行v-bind -->
            </keep-alive>

    </div>
</div><!--app尾-->



        <script>
        //管理員管理
        Vue.component('back-manager', { 
            data(){
                return{
                    link : "allManagers",
                    page1style: "back_btn1",
                    page2style: "back_btn2",
                    managers:[],
                    manager:{
                        MGR_NO:'',
                        MGR_USER:'',
                        MGR_PSW:'',
                    }
                }
            },
            methods:{
                page1(){
                    this.link = 'allManagers'
                    this.page1style= "back_btn1",
                    this.page2style= "back_btn2"

                },
                page2(){
                    this.link = 'addManager'
                    this.page1style= "back_btn2",
                    this.page2style= "back_btn1"
                },
                createMgr(){
                    axios.post('php/backstage/backstage_addmgr.php', this.manager).then(this.manager = {}).then(res => {
                        if(res.status === 201) { 
                            this.getList()
                        }
                    })
                },
                delMgr(u){
                    // console.log(u)
                    alert(u);
                    alert('確認刪除');
                    axios.post('php/backstage/backstage_delmgr.php', u)
                },
                getList() {
                    let url = 'php/backstage/backstage_mgr.php'
                    axios.get(url)
                    .then(res => {
                        this.managers = res.data;
                    })
                    
                },
            },
            created() {
                axios.get('php/backstage/backstage_mgr.php').then(res => {
                this.managers = res.data; 
                })
            },
            template: `
            <div>
                <div class="back_manager_area back_area">
                <div class="back_title">管理員管理</div>
                <div class="back_btn_style">
                    <button :class="page1style" @click="page1">管理員</button>
                    <button :class="page2style" @click="page2">新增管理員</button>
                </div>
                    <div v-if="link == 'allManagers'">
                        <table class="back_manager_table1 back_table">
                            <tr>
                                <th>管理員帳號</th>
                                <th>管理員姓名</th>
                                <th>管理員密碼</th>
                                <th>刪除</th>
                            </tr>
                            <tr v-for="manager in managers">
                                <input type="hidden" v-model="manager.MGR_NO" >
                                    <td>
                                        {{manager.MGR_NO }}
                                    </td>
                                    <td>
                                        {{manager.MGR_USER }}
                                    </td>
                                    <td>
                                        {{manager.MGR_PSW }}
                                    </td>
                                    <td><button @click="delMgr(manager.MGR_NO)" type="button" >刪除</button></td>
                                    
                                </tr>
                        </table>
                    </div>
                    <div class="add_manager" v-else-if="link == 'addManager'">
                        <form >
                            <p>
                                <label>管理員帳號：</label>
                                <input type="text" v-model="manager.MGR_NO">
                            </p>
                            <p>
                                <label>管理員姓名：</label>
                                <input type="text" v-model="manager.MGR_USER">
                            </p>

                            <p>
                                <label>管理員密碼：</label>
                                <input type="text" v-model="manager.MGR_PSW">
                            </p>
                        <input @click="createMgr" type="button" class="thirdbtn1_green back_send" value="送出"></input>
                        </form>
                    </div>
                </div>
            </div>
            `,
        });
        //揪團檢舉管理
        Vue.component('back-rep-group', { 
            data(){
                return{
                    reportgroups:[],
                }
            },
            methods: {                
                updateRegro(){
                        // console.log(m)
                        // axios.post('php/backstage/backstage_modify.php', m)
                    },
            },
            created(){
                axios.get('php/backstage/backstage_reportgroup.php').then(res => {
                this.reportgroups = res.data; 
                })
            },
            template: `
            <div>
                <div class="back_rep_group_area back_area">
                    <div class="back_title">揪團檢舉管理</div>
                    <table class="back_rep_group_table back_table">
                        <tr>
                            <th>編號</th>
                            <th>揪團名稱</th>
                            <th>被檢舉人</th>
                            <th>檢舉原因</th>
                            <th>檢舉狀態</th>
                            <th>揪團狀態</th>
                            <th>確認</th>
                        </tr>
                        <tr v-for="reportgroup in reportgroups">
                            <td>{{reportgroup.REGROUP_NO}}</td>
                            <td>{{reportgroup.GROUP_NAME}}</td>
                            <td>{{reportgroup.MEM_NAME}}</td>
                            <td>{{reportgroup.REGROUP_RESON}}</td>
                            <td>    
                                <input type="radio" name="auth" value="unpass">未通過
                                <p>
                                <input type="radio" name="auth" value="pass">通過&emsp;
                                </p>
                            </td>
                            <td>{{reportgroup.GROUP_STATUS}}</td>
                            <td><button @click="updateRegro()">送出</button></td>
                        </tr>
                    </table>
                </div>
            </div>
                `,
        });
        //揪團留言檢舉管理
        Vue.component('back-rep-message', { 
            data(){
                return{
                    reportmsgs:[],
                }
            },
            methods: {
                updateRemsg(){
                    // console.log(m)
                    // axios.post('php/backstage/backstage_modify.php', m)
                },
            },
            created(){
                axios.get('php/backstage/backstage_reportmsg.php').then(res=>{
                    this.reportmsgs = res.data;
                })
            },
            template: `
            <div>
                <div class="back_rep_message_area back_area">
                <div class="back_title">揪團留言檢舉管理</div>
                    <table class="back_rep_message_table back_table">
                        <tr>
                            <th>編號</th>
                            <th>留言內容</th>
                            <th>被檢舉人</th>
                            <th>檢舉原因</th>
                            <th>檢舉狀態</th>
                            <th>留言狀態</th>
                            <th>確認</th>
                        </tr>
                        <tr v-for="reportmsg in reportmsgs">
                            <td>{{ reportmsg.REGROUP_MES_NO }}</td>
                            <td>{{ reportmsg.GROUP_MES_CONTENT }}</td>
                            <td>{{ reportmsg.MEM_NAME }}</td>
                            <td>{{ reportmsg.REGROUP_RESON }}</td>
                            <td>
                                <input type="radio" name="auth" value="unpass">未通過
                                <p>
                                <input type="radio" name="auth" value="pass">通過&emsp;
                                </p>    
                            </td>
                            <td>{{reportmsg.GROUP_MES_STATUS}}</td>
                            <td><button @click="updateRemsg(manager)">送出</button></td>
                        </tr>
                    </table>
                </div>
            </div>
            `,
        });
        //設備檢舉管理
        Vue.component('back-rep-equ', { 
            data(){
                return{
                    reportequs:[],
                }
            },
            methods: {                
                updateReequ(){
                        // console.log(m)
                        // axios.post('php/backstage/backstage_modify.php', m)
                    },
            },
            created(){
                axios.get('php/backstage/backstage_reportequ.php').then(res=>{
                    this.reportequs = res.data;
                })
            },
            template: `
            <div>
                <div class="back_rep_equ_area back_area">
                    <div class="back_title">設備檢舉管理</div>
                    <table class="back_rep_equ_table back_table">
                        <tr>
                            <th>編號</th>
                            <th>設備名稱</th>
                            <th>被檢舉人</th>
                            <th>檢舉原因</th>
                            <th>檢舉狀態</th>
                            <th>設備狀態</th>
                            <th>確認</th>
                        </tr>
                        <tr v-for="reportequ in reportequs">
                            <td>{{reportequ.REP_OUT_NO}}</td>
                            <td>{{reportequ.EQU_NAME}}</td>
                            <td>{{reportequ.MEM_NAME}}</td>
                            <td>{{reportequ.REPOUP_RESON}}</td>
                            <td>
                                <input type="radio" name="auth" value="unpass">未通過
                                <p>
                                <input type="radio" name="auth" value="pass">通過&emsp;
                                </p>     
                            </td>
                            <td>{{reportequ.EQU_SWAPATATNO}}</td>
                            <td><button @click="updateReequ(manager)">送出</button></td>
                        </tr>
                    </table>
                </div>
            </div>
            `,
        });//小知識管理
        //小遊戲
        Vue.component('back-game-manage', { 
            template: `
            <div>
                <div class="back_game_manger_area back_area">
                    <div class="back_title">小知識管理</div>
                    <div class="back_loginbtn back_add">新增</div>
                    <table class="back_game_manger_table back_table">
                        <tr>
                            <th>題目編號</th>
                            <th>遊戲題目</th>
                            <th>選項</th>
                            <th>正確解答</th>
                            <th>狀態</th>
                        </tr>
                        <tr>
                            <td>001</td>
                            <td>請問露營遇到熊怎麼辦？</td>
                            <td>
                            <p>A：與熊搏鬥</p>
                            <p>B：爬到樹上</p>
                            <p>C：趕緊逃跑</p>
                            </td>
                            <td>C</td>
                            <td><input type="checkbox" class="switch"></td>
                        </tr>
                        <tr>
                            <td>002</td>
                            <td>請問露營遇到熊怎麼辦？</td>
                            <td>
                            <p>A：與熊搏鬥</p>
                            <p>B：爬到樹上</p>
                            <p>C：趕緊逃跑</p>
                            </td>
                            <td>A</td>
                            <td><input type="checkbox" class="switch"></td>
                        </tr>
                        <tr>
                            <td>003</td>
                            <td>請問露營遇到熊怎麼辦？</td>
                            <td>
                            <p>A：與熊搏鬥</p>
                            <p>B：爬到樹上</p>
                            <p>C：趕緊逃跑</p>
                            </td>
                            <td>D</td>
                            <td><input type="checkbox" class="switch"></td>
                        </tr>
                    </table>
                </div>
            </div>
            `,
        });



        new Vue({ 
            el:'#app', 
            data:{
                content:'back-manager',
            },
        });



    </script>
</body>
</html>