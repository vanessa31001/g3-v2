<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="../../vender/jquery/jquery-3.5.1.min.js"></script>
    <style>
        img{
            width: 60px;
        }
    </style>
</head>
<body>
    <div class="pic">
        <label class="uploadImg">
            <input type="file" id="theFile" accept="image/png, image/jpeg"   multiple>
        </label>
        <div class="imgs">
            <div class="img" id="img0">
            </div>
            <div class="img" id="img1">
            </div>
            <div class="img" id="img2">
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function(){
            //上傳圖片
            $("#theFile").change(function(){
                var imgPath = $(this)[0].value;
                var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
                if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
                    if (typeof (FileReader) != "undefined") {
                        for (var i = 0; i < 3; i++) {
                            let image_holder= $("#img"+i);
                            image_holder.empty();
                            var reader = new FileReader();
                            reader.onload = function (e) {
                                $("<img />", {
                                    "src": e.target.result,
                                    // "class": "thumb-image"
                                }).appendTo(image_holder);
                            }
                            image_holder.show();
                            reader.readAsDataURL($(this)[0].files[i]);
                        }
                    } else {
                        alert("This browser does not support FileReader.");
                    }
                }else{
                    alert("Pls select only images");
                }
            });           
        });
    </script>
    <script>
        const fileUploader = document.querySelector('#theFile');
        fileUploader.addEventListener('change', (e) => {
            // console.log(e.target.files); // get file object
            const form = new FormData();
            for(i=0;i<3;i++){
                form.append(`upFile[${i}]`, e.target.files[i]);
            }
            const object = {};
            form.forEach((value,key) => {object[key] = value;});
            console.log(object);
            let xhr = new XMLHttpRequest();
            xhr.onload = function(){
            if(xhr.status == 200){ //success
                    console.log(xhr.responseText);
                    let groupsdata = JSON.parse(xhr.responseText);
                    console.log(groupsdata);
                    
                }else{ //error
                    alert(xhr.responseText);
                }
            }
            xhr.open("Post", "./createNewGroup.php", true);
            xhr.setRequestHeader("content-type","multipart/form-data");
            xhr.send(form); 
        });
        
        
    </script>
</body>
</html>